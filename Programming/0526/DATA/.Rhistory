stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else{
sys<-0
}
}
}else if(length(which(stat.cus == 0)) == 0){
t<-t+E[,2]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[(stat.cus == -1 | stat.cus == 1)]+E[,2]
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
}else{
sys<-0
}
}
}
print(stat.cus)
print(t.W)
if(sys == 0){
t<-t+E[,1]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[which(stat.cus == -1 | stat.cus == 1)]+E[,1]
e1<-exp_rng(z,l1,1)$data
z<-exp_rng(z,l1,1)$n_seed
E[,1]<-e1
stat.cus[min(which(stat.cus == 0))]<-1
sys<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else if(sys == 1){
if(length(which(stat.cus == 0)) > 0){
t<-t+min(E)
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[which(stat.cus == -1 | stat.cus == 1)]+min(E)
E<-E-min(E)
e.ing<-as.numeric(which.min(E))
if(e.ing == 1){
e1<-exp_rng(z,l1,1)$data
z<-exp_rng(z,l1,1)$n_seed
E[,1]<-e1
stat.cus[min(which(stat.cus == 0))]<-(-1)
}else if(e.ing == 2){
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else{
sys<-0
}
}
}else if(length(which(stat.cus == 0)) == 0){
t<-t+E[,2]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[(stat.cus == -1 | stat.cus == 1)]+E[,2]
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
}else{
sys<-0
}
}
}
print(stat.cus)
print(t.W)
if(sys == 0){
t<-t+E[,1]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[which(stat.cus == -1 | stat.cus == 1)]+E[,1]
e1<-exp_rng(z,l1,1)$data
z<-exp_rng(z,l1,1)$n_seed
E[,1]<-e1
stat.cus[min(which(stat.cus == 0))]<-1
sys<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else if(sys == 1){
if(length(which(stat.cus == 0)) > 0){
t<-t+min(E)
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[which(stat.cus == -1 | stat.cus == 1)]+min(E)
E<-E-min(E)
e.ing<-as.numeric(which.min(E))
if(e.ing == 1){
e1<-exp_rng(z,l1,1)$data
z<-exp_rng(z,l1,1)$n_seed
E[,1]<-e1
stat.cus[min(which(stat.cus == 0))]<-(-1)
}else if(e.ing == 2){
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else{
sys<-0
}
}
}else if(length(which(stat.cus == 0)) == 0){
t<-t+E[,2]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[(stat.cus == -1 | stat.cus == 1)]+E[,2]
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
}else{
sys<-0
}
}
}
print(stat.cus)
print(t.W)
if(sys == 0){
t<-t+E[,1]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[which(stat.cus == -1 | stat.cus == 1)]+E[,1]
e1<-exp_rng(z,l1,1)$data
z<-exp_rng(z,l1,1)$n_seed
E[,1]<-e1
stat.cus[min(which(stat.cus == 0))]<-1
sys<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else if(sys == 1){
if(length(which(stat.cus == 0)) > 0){
t<-t+min(E)
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[which(stat.cus == -1 | stat.cus == 1)]+min(E)
E<-E-min(E)
e.ing<-as.numeric(which.min(E))
if(e.ing == 1){
e1<-exp_rng(z,l1,1)$data
z<-exp_rng(z,l1,1)$n_seed
E[,1]<-e1
stat.cus[min(which(stat.cus == 0))]<-(-1)
}else if(e.ing == 2){
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else{
sys<-0
}
}
}else if(length(which(stat.cus == 0)) == 0){
t<-t+E[,2]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[(stat.cus == -1 | stat.cus == 1)]+E[,2]
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
}else{
sys<-0
}
}
}
print(stat.cus)
print(t.W)
if(sys == 0){
t<-t+E[,1]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[which(stat.cus == -1 | stat.cus == 1)]+E[,1]
e1<-exp_rng(z,l1,1)$data
z<-exp_rng(z,l1,1)$n_seed
E[,1]<-e1
stat.cus[min(which(stat.cus == 0))]<-1
sys<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else if(sys == 1){
if(length(which(stat.cus == 0)) > 0){
t<-t+min(E)
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[which(stat.cus == -1 | stat.cus == 1)]+min(E)
E<-E-min(E)
e.ing<-as.numeric(which.min(E))
if(e.ing == 1){
e1<-exp_rng(z,l1,1)$data
z<-exp_rng(z,l1,1)$n_seed
E[,1]<-e1
stat.cus[min(which(stat.cus == 0))]<-(-1)
}else if(e.ing == 2){
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else{
sys<-0
}
}
}else if(length(which(stat.cus == 0)) == 0){
t<-t+E[,2]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[(stat.cus == -1 | stat.cus == 1)]+E[,2]
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
}else{
sys<-0
}
}
}
print(stat.cus)
print(t.W)
if(sys == 0){
t<-t+E[,1]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[which(stat.cus == -1 | stat.cus == 1)]+E[,1]
e1<-exp_rng(z,l1,1)$data
z<-exp_rng(z,l1,1)$n_seed
E[,1]<-e1
stat.cus[min(which(stat.cus == 0))]<-1
sys<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else if(sys == 1){
if(length(which(stat.cus == 0)) > 0){
t<-t+min(E)
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[which(stat.cus == -1 | stat.cus == 1)]+min(E)
E<-E-min(E)
e.ing<-as.numeric(which.min(E))
if(e.ing == 1){
e1<-exp_rng(z,l1,1)$data
z<-exp_rng(z,l1,1)$n_seed
E[,1]<-e1
stat.cus[min(which(stat.cus == 0))]<-(-1)
}else if(e.ing == 2){
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else{
sys<-0
}
}
}else if(length(which(stat.cus == 0)) == 0){
t<-t+E[,2]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[(stat.cus == -1 | stat.cus == 1)]+E[,2]
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
}else{
sys<-0
}
}
}
print(stat.cus)
print(t.W)
if(sys == 0){
t<-t+E[,1]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[which(stat.cus == -1 | stat.cus == 1)]+E[,1]
e1<-exp_rng(z,l1,1)$data
z<-exp_rng(z,l1,1)$n_seed
E[,1]<-e1
stat.cus[min(which(stat.cus == 0))]<-1
sys<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else if(sys == 1){
if(length(which(stat.cus == 0)) > 0){
t<-t+min(E)
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[which(stat.cus == -1 | stat.cus == 1)]+min(E)
E<-E-min(E)
e.ing<-as.numeric(which.min(E))
if(e.ing == 1){
e1<-exp_rng(z,l1,1)$data
z<-exp_rng(z,l1,1)$n_seed
E[,1]<-e1
stat.cus[min(which(stat.cus == 0))]<-(-1)
}else if(e.ing == 2){
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else{
sys<-0
}
}
}else if(length(which(stat.cus == 0)) == 0){
t<-t+E[,2]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[(stat.cus == -1 | stat.cus == 1)]+E[,2]
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
}else{
sys<-0
}
}
}
print(stat.cus)
print(t.W)
if(sys == 0){
t<-t+E[,1]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[which(stat.cus == -1 | stat.cus == 1)]+E[,1]
e1<-exp_rng(z,l1,1)$data
z<-exp_rng(z,l1,1)$n_seed
E[,1]<-e1
stat.cus[min(which(stat.cus == 0))]<-1
sys<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else if(sys == 1){
if(length(which(stat.cus == 0)) > 0){
t<-t+min(E)
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[which(stat.cus == -1 | stat.cus == 1)]+min(E)
E<-E-min(E)
e.ing<-as.numeric(which.min(E))
if(e.ing == 1){
e1<-exp_rng(z,l1,1)$data
z<-exp_rng(z,l1,1)$n_seed
E[,1]<-e1
stat.cus[min(which(stat.cus == 0))]<-(-1)
}else if(e.ing == 2){
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else{
sys<-0
}
}
}else if(length(which(stat.cus == 0)) == 0){
t<-t+E[,2]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[(stat.cus == -1 | stat.cus == 1)]+E[,2]
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
}else{
sys<-0
}
}
}
print(stat.cus)
print(t.W)
if(sys == 0){
t<-t+E[,1]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[which(stat.cus == -1 | stat.cus == 1)]+E[,1]
e1<-exp_rng(z,l1,1)$data
z<-exp_rng(z,l1,1)$n_seed
E[,1]<-e1
stat.cus[min(which(stat.cus == 0))]<-1
sys<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else if(sys == 1){
if(length(which(stat.cus == 0)) > 0){
t<-t+min(E)
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[which(stat.cus == -1 | stat.cus == 1)]+min(E)
E<-E-min(E)
e.ing<-as.numeric(which.min(E))
if(e.ing == 1){
e1<-exp_rng(z,l1,1)$data
z<-exp_rng(z,l1,1)$n_seed
E[,1]<-e1
stat.cus[min(which(stat.cus == 0))]<-(-1)
}else if(e.ing == 2){
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else{
sys<-0
}
}
}else if(length(which(stat.cus == 0)) == 0){
t<-t+E[,2]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[(stat.cus == -1 | stat.cus == 1)]+E[,2]
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
}else{
sys<-0
}
}
}
print(stat.cus)
print(t.W)
if(sys == 0){
t<-t+E[,1]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[which(stat.cus == -1 | stat.cus == 1)]+E[,1]
e1<-exp_rng(z,l1,1)$data
z<-exp_rng(z,l1,1)$n_seed
E[,1]<-e1
stat.cus[min(which(stat.cus == 0))]<-1
sys<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else if(sys == 1){
if(length(which(stat.cus == 0)) > 0){
t<-t+min(E)
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[which(stat.cus == -1 | stat.cus == 1)]+min(E)
E<-E-min(E)
e.ing<-as.numeric(which.min(E))
if(e.ing == 1){
e1<-exp_rng(z,l1,1)$data
z<-exp_rng(z,l1,1)$n_seed
E[,1]<-e1
stat.cus[min(which(stat.cus == 0))]<-(-1)
}else if(e.ing == 2){
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
}else{
sys<-0
}
}
}else if(length(which(stat.cus == 0)) == 0){
t<-t+E[,2]
t.W[which(stat.cus == -1 | stat.cus == 1)]<-t.W[(stat.cus == -1 | stat.cus == 1)]+E[,2]
e2<-exp_rng(z,l2,1)$data
z<-exp_rng(z,l2,1)$n_seed
E[,2]<-e2
stat.cus[which(stat.cus == 1)]<-2
if(length(which(stat.cus == -1))>0){
stat.cus[min(which(stat.cus == -1))]<-1
}else{
sys<-0
}
}
}
print(stat.cus)
print(t.W)
pcaqq = prcomp(qq, center = T, scale = T)
rm(list=ls())
qq=read.csv("(去程)路線11搭車習慣.csv")
qq<-qq[-1]
comdata<-read.csv("(去程)替代路名對照.csv" ,header = TRUE, sep = ",")
n11<-c("台東","新生站","中央市場","署東醫院","簡易法庭","變電所","新生國小","更生路","四維路口",
"馬蘭加油站","公東高工","馬蘭榮家","卑南農會","卑南","卑南國小","南王",
"卑南國中","十股","下賓朗","賓朗","種蓄場","美濃入口","東成","美濃","集貨場","煙草間","初鹿國中",
"明峰","初鹿","龍過脈","嘉豐入口","舊鹿鳴","四維","湖底","龍田","光榮","鹿野國中","鹿野","鹿野鄉公所","水源地",
"永隆","永隆分校","永興","永安農場","武陵","武麟山莊","新豐","景豐","加拿","月眉國小",
"月眉","崁頂","親水公園","關山","關山慈濟","螢橋","德高","頂庄","北庄","山平路","海端","隴下","初來","錦屏","陸安",
"大同農場","池上鄉公所","池上郵局","池上站","慶豐","富南國小","富里")
for(i in c(1:nrow(comdata))){       #替換掉站名
for(j in c(1:length(n11))){
if(comdata[i,1]==n11[j]){
n11[j]=as.character(comdata[i,2])
}
}
}
colnames(qq)<-n11
pcaqq = prcomp(qq, center = T, scale = T)
rm(list=ls())
qq=read.csv("(去程)路線11搭車習慣.csv")
setwd("C:/Users/user/Desktop/AMSA/FINAL/目前最新/0526/DATA")
qq=read.csv("(去程)路線11搭車習慣.csv")
qq<-qq[-1]
comdata<-read.csv("(去程)替代路名對照.csv" ,header = TRUE, sep = ",")
n11<-c("台東","新生站","中央市場","署東醫院","簡易法庭","變電所","新生國小","更生路","四維路口",
"馬蘭加油站","公東高工","馬蘭榮家","卑南農會","卑南","卑南國小","南王",
"卑南國中","十股","下賓朗","賓朗","種蓄場","美濃入口","東成","美濃","集貨場","煙草間","初鹿國中",
"明峰","初鹿","龍過脈","嘉豐入口","舊鹿鳴","四維","湖底","龍田","光榮","鹿野國中","鹿野","鹿野鄉公所","水源地",
"永隆","永隆分校","永興","永安農場","武陵","武麟山莊","新豐","景豐","加拿","月眉國小",
"月眉","崁頂","親水公園","關山","關山慈濟","螢橋","德高","頂庄","北庄","山平路","海端","隴下","初來","錦屏","陸安",
"大同農場","池上鄉公所","池上郵局","池上站","慶豐","富南國小","富里")
for(i in c(1:nrow(comdata))){       #替換掉站名
for(j in c(1:length(n11))){
if(comdata[i,1]==n11[j]){
n11[j]=as.character(comdata[i,2])
}
}
}
colnames(qq)<-n11
pcaqq = prcomp(qq, center = T, scale = T)
pcaqq$rotation[,-1]
pcaqq$rotation[,1]
