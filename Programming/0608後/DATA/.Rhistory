vars <- (pcaqq$sdev)^2
vars
props <- vars / sum(vars)
props
cumulative.props <- cumsum(props)  # 累加前n個元素的值
cumulative.props
windows()
plot(cumulative.props,xlab = "PCA個數", ylab = "cumulative variance" )
top2.pca.eigenvector <- pcaqq$rotation[, 1:2]
top3.pca.eigenvector <- pcaqq$rotation[, 1:3]
top8.pca.eigenvector <- pcaqq$rotation[, 1:8]
PCAPt2=t(qq)%*%top2.pca.eigenvector ############# 6/1 revised
PCAPt3=t(qq)%*%top3.pca.eigenvector ############# 6/1 revised
PCAPt8=t(qq)%*%top8.pca.eigenvector ############# 6/1 revised
kms2<-kmeans(PCAPt2, 4)
kms3<-kmeans(PCAPt3, 4)
kms8<-kmeans(PCAPt8, 4)
kms3$cluster
kms8<-kmeans(PCAPt8, 3)
plot(PCAPt2, col = kms2$cluster )#, xlim = c(-10,50), ylim = c(-45,10))
points(kms2$centers, col = 1:4, pch = 1, cex = 30)
points(kms2$centers, col = 1:4, pch = 1, cex = 20)
points(kms2$centers, col = 1:4, pch = 1, cex = 10)
points(kms2$centers, col = 1:4, pch = 8, cex = 2)
points(PCAPt2[2,], col = "dark orange", pch = 9, cex = 8)
max(PCAPt2[,1])
max(PCAPt2[,2])
min(PCAPt2[,1])
min(PCAPt2[,2])
library(rgl)
plot3d(PCAPt3 , size = 10, type = "p")
plot3d(PCAPt3 , col = kms3$cluster, size = 3, type = "n")
text3d(PCAPt3, text = n11, col = kms3$cluster)
for(i in 1:4){
pch3d(t(kms3$centers[i,]), col = i, radius = 100, lwd = 2)
}
which(kms3$cluster==1)
which(kms3$cluster==2)
which(kms3$cluster==3)
which(kms3$cluster==4)
which(kms3$cluster==5)
which(kms3$cluster==6)
which(kms3$cluster==7)
library(ggplot2)
windows()
barplot(colSums( qq )) # 每一站(年)使用次數
A<- data.frame(counts = colSums( qq ))
ggplot(data=A , aes(x= row.names(A) ,y= counts )) + geom_bar(stat = "identity") + xlab("站點") + ylab("刷卡次數") +
coord_flip()   ;rm(A)
# ^
# |  0608
rm(list=ls())
qq=read.csv("(去程)路線11老人搭車習慣.csv")
qq[1:10,1:10]
comdata<-read.csv("(去程)替代路名對照.csv" ,header = TRUE, sep = ",")
n11<-c("台東","新生站","中央市場","署東醫院","簡易法庭","變電所","新生國小","更生路","四維路口",
"馬蘭加油站","公東高工","馬蘭榮家","卑南農會","卑南","卑南國小","南王",
"卑南國中","十股","下賓朗","賓朗","種蓄場","美濃入口","東成","美濃","集貨場","煙草間","初鹿國中",
"明峰","初鹿","龍過脈","嘉豐入口","舊鹿鳴","四維","湖底","龍田","光榮","鹿野國中","鹿野","鹿野鄉公所","水源地",
"永隆","永隆分校","永興","永安農場","武陵","武麟山莊","新豐","景豐","加拿","月眉國小",
"月眉","崁頂","親水公園","關山","關山慈濟","螢橋","德高","頂庄","北庄","山平路","海端","隴下","初來","錦屏","陸安",
"大同農場","池上鄉公所","池上郵局","池上站","慶豐","富南國小","富里")
for(i in c(1:nrow(comdata))){       #替換掉站名
for(j in c(1:length(n11))){
if(comdata[i,1]==n11[j]){
n11[j]=as.character(comdata[i,2])
}
}
}
colnames(qq)<-n11
pcaqq = prcomp(t(qq), center = T) ############# 6/1 revised
pcaqq$sdev
vars <- (pcaqq$sdev)^2
vars
props <- vars / sum(vars)
props
cumulative.props <- cumsum(props)  # 累加前n個元素的值
cumulative.props
windows()
plot(cumulative.props,xlab = "PCA個數", ylab = "cumulative variance" )
top2.pca.eigenvector <- pcaqq$rotation[, 1:2]
top3.pca.eigenvector <- pcaqq$rotation[, 1:3]
top8.pca.eigenvector <- pcaqq$rotation[, 1:8]
PCAPt2=t(qq)%*%top2.pca.eigenvector ############# 6/1 revised
PCAPt3=t(qq)%*%top3.pca.eigenvector ############# 6/1 revised
PCAPt8=t(qq)%*%top8.pca.eigenvector ############# 6/1 revised
kms2<-kmeans(PCAPt2, 4)
kms3<-kmeans(PCAPt3, 4)
kms8<-kmeans(PCAPt8, 4)
kms3$cluster
kms8<-kmeans(PCAPt8, 3)
plot(PCAPt2, col = kms2$cluster )#, xlim = c(-10,50), ylim = c(-45,10))
points(kms2$centers, col = 1:4, pch = 1, cex = 30)
points(kms2$centers, col = 1:4, pch = 1, cex = 20)
points(kms2$centers, col = 1:4, pch = 1, cex = 10)
points(kms2$centers, col = 1:4, pch = 8, cex = 2)
points(PCAPt2[2,], col = "dark orange", pch = 9, cex = 8)
max(PCAPt2[,1])
max(PCAPt2[,2])
min(PCAPt2[,1])
min(PCAPt2[,2])
library(rgl)
plot3d(PCAPt3 , size = 10, type = "p")
plot3d(PCAPt3 , col = kms3$cluster, size = 3, type = "n")
text3d(PCAPt3, text = n11, col = kms3$cluster)
for(i in 1:4){
pch3d(t(kms3$centers[i,]), col = i, radius = 100, lwd = 2)
}
which(kms3$cluster==1)
which(kms3$cluster==2)
which(kms3$cluster==3)
which(kms3$cluster==4)
which(kms3$cluster==5)
which(kms3$cluster==6)
which(kms3$cluster==7)
library(ggplot2)
windows()
barplot(colSums( qq )) # 每一站(年)使用次數
A<- data.frame(counts = colSums( qq ))
ggplot(data=A , aes(x= row.names(A) ,y= counts )) + geom_bar(stat = "identity") + xlab("站點") + ylab("刷卡次數") +
coord_flip()   ;rm(A)
qq=read.csv("(去程)路線11學生票.csv")
setwd("C:/Users/user/Desktop/AMSA/FINAL/目前最新/0608後/DATA")
qq[1:10,1:10]
rm(list=ls())
qq=read.csv("(去程)路線11.csv")
setwd("C:/Users/user/Desktop/AMSA/FINAL/目前最新/0608後/DATA/Old Data")
rm(list=ls())
qq=read.csv("(去程)路線11.csv")
qq
ggplot(data = qq , aes(x= n11 ,y= qq[,3] )) + geom_bar(stat = "identity") + xlab("站點") + ylab("刷卡次數") +
coord_flip()   ;rm(A)
n11<-c("台東","新生站","中央市場","署東醫院","簡易法庭","變電所","新生國小","更生路","四維路口",
"馬蘭加油站","公東高工","馬蘭榮家","卑南農會","卑南","卑南國小","南王",
"卑南國中","十股","下賓朗","賓朗","種蓄場","美濃入口","東成","美濃","集貨場","煙草間","初鹿國中",
"明峰","初鹿","龍過脈","嘉豐入口","舊鹿鳴","四維","湖底","龍田","光榮","鹿野國中","鹿野","鹿野鄉公所","水源地",
"永隆","永隆分校","永興","永安農場","武陵","武麟山莊","新豐","景豐","加拿","月眉國小",
"月眉","崁頂","親水公園","關山","關山慈濟","螢橋","德高","頂庄","北庄","山平路","海端","隴下","初來","錦屏","陸安",
"大同農場","池上鄉公所","池上郵局","池上站","慶豐","富南國小","富里")
ggplot(data = qq , aes(x= n11 ,y= qq[,3] )) + geom_bar(stat = "identity") + xlab("站點") + ylab("刷卡次數") +
coord_flip()   ;rm(A)
rm(list=ls())
qqn=read.csv("(去程)路線11.csv")
n11<-c("台東","新生站","中央市場","署東醫院","簡易法庭","變電所","新生國小","更生路","四維路口",
"馬蘭加油站","公東高工","馬蘭榮家","卑南農會","卑南","卑南國小","南王",
"卑南國中","十股","下賓朗","賓朗","種蓄場","美濃入口","東成","美濃","集貨場","煙草間","初鹿國中",
"明峰","初鹿","龍過脈","嘉豐入口","舊鹿鳴","四維","湖底","龍田","光榮","鹿野國中","鹿野","鹿野鄉公所","水源地",
"永隆","永隆分校","永興","永安農場","武陵","武麟山莊","新豐","景豐","加拿","月眉國小",
"月眉","崁頂","親水公園","關山","關山慈濟","螢橋","德高","頂庄","北庄","山平路","海端","隴下","初來","錦屏","陸安",
"大同農場","池上鄉公所","池上郵局","池上站","慶豐","富南國小","富里")
qq<-read.csv("(去程)路線11搭車習慣.csv")
library(ggplot2)
A<- data.frame(counts = colSums( qq ))
qq
qq<-qq[-1]
A<- data.frame(counts = colSums( qq ))
ggplot(data = qq , aes(x= n11 ,y= A )) + geom_bar(stat = "identity") + xlab("站點") + ylab("刷卡次數") +
coord_flip()   ;rm(A)
A
ggplot(data = qqn , aes(x= n11 ,y= A )) + geom_bar(stat = "identity") + xlab("站點") + ylab("刷卡次數") +
coord_flip()   ;rm(A)
qqn
ggplot(data = qqn[,3] , x=reorder(Dogtrain$breed,Count)) + geom_bar(stat = "identity") + xlab("站點") + ylab("刷卡次數") +
coord_flip()   ;rm(A)
ggplot(data = qqn[,3] , x=n11) + geom_bar(stat = "identity") + xlab("站點") + ylab("刷卡次數") +
coord_flip()   ;rm(A)
qqn[,3]
ggplot(data = data.frame(qqn[,3]) , x=n11) + geom_bar(stat = "identity") + xlab("站點") + ylab("刷卡次數") +
coord_flip()   ;rm(A)
ggplot(data = qqn[,3] , x=(qqn[,3],count)) + geom_bar(stat = "identity") + xlab("站點") + ylab("刷卡次數") +
coord_flip()   ;rm(A)
ggplot(data = qqn[,3] , x=(qqn[,3],count)) + geom_bar(stat = "identity") + xlab("站點") + ylab("刷卡次數") +
coord_flip()   ;rm(A)
A<- data.frame(counts = colSums( qq ))
ggplot(data = qqn[,3] , x=(qqn[,3],count)) + geom_bar(stat = "identity") + xlab("站點") + ylab("刷卡次數") +
coord_flip()   ;rm(A)
ggplot(data = qqn[,3] , x=reorder(qqn[,3],count)) + geom_bar(stat = "identity") + xlab("站點") + ylab("刷卡次數") +
coord_flip()   ;rm(A)
ggplot(data = qqn , x=reorder(qqn[,3],count)) + geom_bar(stat = "identity") + xlab("站點") + ylab("刷卡次數") +
coord_flip()   ;rm(A)
ggplot(data = qqn , aes(x=reorder(qqn[,3],count))) + geom_bar(stat = "identity") + xlab("站點") + ylab("刷卡次數") +
coord_flip()   ;rm(A)
ggplot(data = qqn , aes(x=reorder(qqn[,3]))) + geom_bar(stat = "identity") + xlab("站點") + ylab("刷卡次數") +
coord_flip()   ;rm(A)
qplot(qq, data =qqn, fill = qqn[,3])
qplot(qq, data =qqn, fill = "票種")
qplot(qq, data =qqn, color = "票種")
qqn
qq
A<- data.frame(counts = colSums( qq ))
qplot(A, data =qqn, color = "票種")
qqn
A
qplot(A, data =A, color = "票種")
A
qplot(A, data =qq, color = "票種")
qplot(A, data =qqn, color = "票種")
qplot(t(A), data =qqn, color = "票種")
qplot(A, data =qqn, fill = "票種")
qqn
qplot(A, data =qqn, fill = qqn$票種)
qplot(A, data =qqn, fill = 票種)
L_8161<-qqn
ggplot(L_8161, aes(factor(L_8161$上車代號,levels=a1), fill=L_8161$票種))
A
rm(list=ls())
qqn=read.csv("(去程)路線11.csv")
qq[1:10,1:10]
comdata<-read.csv("(去程)替代路名對照.csv" ,header = TRUE, sep = ",")
n11<-c("台東","新生站","中央市場","署東醫院","簡易法庭","變電所","新生國小","更生路","四維路口",
"馬蘭加油站","公東高工","馬蘭榮家","卑南農會","卑南","卑南國小","南王",
"卑南國中","十股","下賓朗","賓朗","種蓄場","美濃入口","東成","美濃","集貨場","煙草間","初鹿國中",
"明峰","初鹿","龍過脈","嘉豐入口","舊鹿鳴","四維","湖底","龍田","光榮","鹿野國中","鹿野","鹿野鄉公所","水源地",
"永隆","永隆分校","永興","永安農場","武陵","武麟山莊","新豐","景豐","加拿","月眉國小",
"月眉","崁頂","親水公園","關山","關山慈濟","螢橋","德高","頂庄","北庄","山平路","海端","隴下","初來","錦屏","陸安",
"大同農場","池上鄉公所","池上郵局","池上站","慶豐","富南國小","富里")
for(i in c(1:nrow(comdata))){       #替換掉站名
for(j in c(1:length(n11))){
if(comdata[i,1]==n11[j]){
n11[j]=as.character(comdata[i,2])
}
}
}
colnames(qq)<-n11
pcaqq = prcomp(t(qq), center = T) ############# 6/1 revised
pcaqq$sdev
vars <- (pcaqq$sdev)^2
vars
props <- vars / sum(vars)
props
cumulative.props <- cumsum(props)  # 累加前n個元素的值
cumulative.props
windows()
plot(cumulative.props,xlab = "PCA個數", ylab = "cumulative variance" )
# top2.pca.eigenvector <- pcaqq$rotation[, 1:2]
top3.pca.eigenvector <- pcaqq$rotation[, 1:3]
# top8.pca.eigenvector <- pcaqq$rotation[, 1:8]
# PCAPt2=t(qq)%*%top2.pca.eigenvector ############# 6/1 revised
PCAPt3=t(qq)%*%top3.pca.eigenvector ############# 6/1 revised
# PCAPt8=t(qq)%*%top8.pca.eigenvector ############# 6/1 revised
# kms2<-kmeans(PCAPt2, 4)
kms3<-kmeans(PCAPt3, 4)
# kms8<-kmeans(PCAPt8, 4)
kms3$cluster
# kms8<-kmeans(PCAPt8, 3)
# plot(PCAPt2, col = kms2$cluster )#, xlim = c(-10,50), ylim = c(-45,10))
# points(kms2$centers, col = 1:4, pch = 1, cex = 30)
# points(kms2$centers, col = 1:4, pch = 1, cex = 20)
# points(kms2$centers, col = 1:4, pch = 1, cex = 10)
# points(kms2$centers, col = 1:4, pch = 8, cex = 2)
#
# points(PCAPt2[2,], col = "dark orange", pch = 9, cex = 8)
# max(PCAPt2[,1])
# max(PCAPt2[,2])
#
# min(PCAPt2[,1])
# min(PCAPt2[,2])
library(rgl)
plot3d(PCAPt3 , size = 10, type = "p")
plot3d(PCAPt3 , col = kms3$cluster, size = 3, type = "n")
text3d(PCAPt3, text = n11, col = kms3$cluster)
for(i in 1:4){
pch3d(t(kms3$centers[i,]), col = i, radius = 200, lwd = 2)
}
which(kms3$cluster==1)
which(kms3$cluster==2)
which(kms3$cluster==3)
which(kms3$cluster==4)
# which(kms3$cluster==5)
# which(kms3$cluster==6)
# which(kms3$cluster==7)
qq<-read.csv("(去程)路線11搭車習慣.csv")
qq<-qq[-1]
library(ggplot2)
windows()
barplot(colSums( qq )) # 每一站(年)使用次數
A<- data.frame(counts = colSums( qq ))
A
sum(A)
ggplot(L_8161, aes(factor(c(L_8161$上車站名,L_8161$下車站名),levels=n11), fill=L_8161$票種))
L_8161<-qqn
ggplot(L_8161, aes(factor(c(L_8161$上車站名,L_8161$下車站名),levels=n11), fill=L_8161$票種))
L_8161
c(L_8161$上車站名,L_8161$下車站名)
L_8161$票種
ggplot(L_8161, aes(factor(c(L_8161$上車站名,L_8161$下車站名),levels=n11), fill=c(L_8161$票種,L_8161$票種)))
ggplot
ggplot(L_8161, aes(factor(cbind(L_8161$上車站名,L_8161$下車站名),levels=n11), fill=cbind(L_8161$票種,L_8161$票種)))
ggplot(L_8161, aes(factor(L_8161$上車站名,levels=n11), fill=L_8161$票種,L_8161$票種))
ggplot(L_8161, aes(factor(L_8161$上車站名,levels=n11), fill=L_8161$票種))
+ geom_bar(position="dodge") + ggtitle("[Departure]8161")
+ ylab("count") + xlab("Station") + labs(fill = "Card type")
ggplot(L_8161, aes(factor(L_8161$上車站名,levels=n11), fill=L_8161$票種))
+ geom_bar(position="dodge") + ggtitle("[Departure]8161")
+ ylab("count") + xlab("Station") + labs(fill = "Card type")
+ theme(panel.background=element_rect(fill='transparent',color ="gray"), axis.text.x = element_text(angle = 70, hjust = 0.5, vjust = 0.5,color = "black",size=9))
+ geom_text(position = position_dodge(width = 1), size = 3,stat="count",aes(label=..count..),vjust=-0.2)
L_8161<-qqn
ggplot(L_8161, aes(factor(L_8161$上車站名,levels=n11), fill=L_8161$票種))
+ geom_bar(position="dodge") + ggtitle("[Departure]8161")
ggplot(L_8161, aes(factor(L_8161$上車代號,levels=a1), fill=L_8161$票種)) + geom_bar(position="fill") + ggtitle("[Departure]8161") + ylab("count") + xlab("Station") + labs(fill = "Card type") + theme(panel.background=element_rect(fill='transparent',color ="gray"), axis.text.x = element_text(angle = 70, hjust = 0.5, vjust = 0.5,color = "black",size=9)) + geom_text(position = position_dodge(width = 1), size = 3,stat="count",aes(label=..count..),vjust=-0.2)
ggplot(L_8161, aes(factor(L_8161$上車代號,levels=n11), fill=L_8161$票種)) + geom_bar(position="fill") + ggtitle("[Departure]8161") + ylab("count") + xlab("Station") + labs(fill = "Card type") + theme(panel.background=element_rect(fill='transparent',color ="gray"), axis.text.x = element_text(angle = 70, hjust = 0.5, vjust = 0.5,color = "black",size=9)) + geom_text(position = position_dodge(width = 1), size = 3,stat="count",aes(label=..count..),vjust=-0.2)
qplot(qqn[,3],data=qqn) +geom_bar(aes(fill=qqn[,3]))
qplot(c(qqn$上車站名,qqn$下車站名),data=qqn) +geom_bar(aes(fill=qqn[,3]))
qplot(c(qqn$上車站名,qqn$下車站名),data=qqn) +geom_bar(aes(fill=c(qqn[,3], qqn[,3])))
qplot(c(qqn$上車站名,qqn$下車站名),data=qqn) +geom_bar(aes(fill=qqn[,3]))
qplot(qqn$上車站名,data=qqn) +geom_bar(aes(fill=qqn[,3]))
qplot(qqn$上車站名+qqn$下車站名,data=qqn) +geom_bar(aes(fill=qqn[,3]))
qplot(qqn$上車站名,qqn$下車站名,data=qqn) +geom_bar(aes(fill=qqn[,3]))
qplot(c(qqn$上車站名,qqn$下車站名),data=qqn) +geom_bar(aes(fill=qqn[,3]))
qplot(qqn$上車站名&qqn$下車站名,data=qqn) +geom_bar(aes(fill=qqn[,3]))
qplot(qqn$上車站名&&qqn$下車站名,data=qqn) +geom_bar(aes(fill=qqn[,3]))
qplot(qqn$上車站名,data=qqn) +geom_bar(aes(fill=qqn[,3]))
qplot(qqn$上車站名+qqn$下車站名,data=qqn) +geom_bar(aes(fill=qqn[,3]))
qplot(qqn$上車站名,qqn$下車站名,data=qqn) +geom_bar(aes(fill=qqn[,3]))
qplot(qqn$上車站名,data=qqn) +geom_bar(aes(fill=qqn[,3]))
qplot(rbind(qqn$上車站名,qqn$下車站名),data=rbind(qqn,qqn)) +geom_bar(aes(fill=qqn[,3]))
qplot(rbind(qqn$上車站名,qqn$下車站名),data=rbind(qqn,qqn)) +geom_bar(aes(fill=rbind(qqn[,3], qqn[,3])))
qplot(cbind(qqn$上車站名,qqn$下車站名),data=cbind(qqn,qqn)) +geom_bar(aes(fill=cbind(qqn[,3], qqn[,3])))
rbind(qqn,qqn)
qqq<-rbind(qqn,qqn)
qplot(rbind(qqn$上車站名,qqn$下車站名),data=qqq) +geom_bar(aes(fill=qqq[,3]))
rbind(qqn$上車站名,qqn$下車站名)
qqn$上車站名
rbind(qqn$上車站名,qqn$下車站名)
qplot(c(qqn$上車站名,qqn$下車站名),data=qqq) +geom_bar(aes(fill=qqq[,3]))
qqq<-c(qqn,qqn)
qplot(c(qqn$上車站名,qqn$下車站名),data=qqq) +geom_bar(aes(fill=qqq[,3]))
qqq<-rbind(qqn,qqn)
qqq[,3]
qplot(c(qqn$上車站名,qqn$下車站名),data=qqq) +geom_bar(aes(fill=qqq[,3]))
ggplot(c(qqn$上車站名,qqn$下車站名),data=qqq) +geom_bar(aes(fill=qqq[,3]))
ggplot(data=qqq , aes(x= n11 ,y= c(qqn$上車站名,qqn$下車站名) )) + geom_bar(stat = "identity") + xlab("站點") + ylab("刷卡次數") +
coord_flip()   ;rm(A)
qqq
qqq[,3]
qplot(c(qqn$上車站名,qqn$下車站名),data=qqq) +geom_bar(aes(fill=qqq[,3]))
qplot(qqn$上車站名,data=qqn) +geom_bar(aes(fill=qq[,3]))
qqn
qplot(qqn$上車站名,data=qqn) +geom_bar(aes(fill=qqn[,3]))
qplot(qqn$上車站名,data=qqn) +geom_bar(aes(fill=qqn[,3]))+
qplot(qqn$下車站名,data=qqn) +geom_bar(aes(fill=qqn[,3]))
qplot(qqn$上車站名,data=qqn) +qplot(qqn$下車站名,data=qqn)+geom_bar(aes(fill=qqn[,3]))
qwe<-c(qqn$上車站名,qqn$下車站名)
qplot(qwe,data=qqq) +geom_bar(aes(fill=qqq[,3]))
qplot(qwe,data=qqq, bins = 4)0 +geom_bar(aes(fill=qqq[,3]))
qplot(qwe,data=qqq, bins = 40) +geom_bar(aes(fill=qqq[,3]))
geom_bar(aes(fill=qqq[,3]))
qplot(qwe,data=qqq, bins = 40)
geom_bar(aes(fill=qqq[,3]))
qplot(qwe,data=qqq, bins = 40) +geom_bar(aes(fill=qqq[,3]))
qplot(qwe,data=qqq, bins = 40) +geom_bar(aes(fill=qqq[,3]), bins = 40)
qplot(qwe,data=qqq) +geom_bar(aes(fill=qqq[,3]), bins = 40)
qplot(qwe,data=qqq, bins = 40) +geom_bar(aes(fill=qqq[,3]))
qplot(qwe,data=qqq, bins = 50) +geom_bar(aes(fill=qqq[,3]))
qplot(qwe,data=qqq, bins = 100) +geom_bar(aes(fill=qqq[,3]))
qplot(qwe,data=qqq, bins = 200) +geom_bar(aes(fill=qqq[,3]))
qplot(qwe,data=qqq, bins = 200) +geom_bar(aes(x= n11,fill=qqq[,3]))
n11
qplot(qwe,data=qqq, bins = 200) +geom_bar(aes(fill=qqq[,3]))
qplot(qwe,data=qqq, bins = 200, row.names(x= n11)) +geom_bar(aes(fill=qqq[,3]))
qplot(qwe,data=qqq, bins = 200) +geom_bar(aes(fill=qqq[,3]))
axis(x,n11)
qplot(qwe,data=qqq, bins = 200) +geom_bar(aes(fill=qqq[,3]))
+axis(x,n11)
qplot(qwe,data=qqq, bins = 200) +geom_bar(aes(fill=qqq[,3]))
+axis(qqq,n11)
qq=read.csv("(去程)路線11老人搭車習慣.csv")
setwd("C:/Users/user/Desktop/AMSA/FINAL/目前最新/0608後/DATA")
rm(list=ls())
qq=read.csv("(去程)路線11老人搭車習慣.csv")
qq[1:10,1:10]
comdata<-read.csv("(去程)替代路名對照.csv" ,header = TRUE, sep = ",")
rm(list=ls())
qqn=read.csv("(去程)路線11.csv")
rm(list=ls())
qq=read.csv("(去程)路線11學生搭車習慣.csv")
qq[1:10,1:10]
comdata<-read.csv("(去程)替代路名對照.csv" ,header = TRUE, sep = ",")
setwd("C:/Users/user/Desktop/AMSA/FINAL/目前最新/0608後/DATA/Old Data")
rm(list=ls())
qq=read.csv("(去程)路線11搭車習慣.csv")
qq<-qq[,-1]
qq[1:10,1:10]
comdata<-read.csv("(去程)替代路名對照.csv" ,header = TRUE, sep = ",")
n11<-c("台東","新生站","中央市場","署東醫院","簡易法庭","變電所","新生國小","更生路","四維路口",
"馬蘭加油站","公東高工","馬蘭榮家","卑南農會","卑南","卑南國小","南王",
"卑南國中","十股","下賓朗","賓朗","種蓄場","美濃入口","東成","美濃","集貨場","煙草間","初鹿國中",
"明峰","初鹿","龍過脈","嘉豐入口","舊鹿鳴","四維","湖底","龍田","光榮","鹿野國中","鹿野","鹿野鄉公所","水源地",
"永隆","永隆分校","永興","永安農場","武陵","武麟山莊","新豐","景豐","加拿","月眉國小",
"月眉","崁頂","親水公園","關山","關山慈濟","螢橋","德高","頂庄","北庄","山平路","海端","隴下","初來","錦屏","陸安",
"大同農場","池上鄉公所","池上郵局","池上站","慶豐","富南國小","富里")
for(i in c(1:nrow(comdata))){       #替換掉站名
for(j in c(1:length(n11))){
if(comdata[i,1]==n11[j]){
n11[j]=as.character(comdata[i,2])
}
}
}
colnames(qq)<-n11
pcaqq = prcomp(qq, center = T) ############# 6/1 revised
pcaqq$sdev
vars <- (pcaqq$sdev)^2
vars
props <- vars / sum(vars)
props
cumulative.props <- cumsum(props)  # 累加前n個元素的值
cumulative.props
windows()
plot(cumulative.props,xlab = "PCA個數", ylab = "cumulative variance" )
# top2.pca.eigenvector <- pcaqq$rotation[, 1:2]
top3.pca.eigenvector <- pcaqq$rotation[, 1:3]
# PCAPt2=t(qq)%*%top2.pca.eigenvector ############# 6/1 revised
PCAPt3=qq%*%top3.pca.eigenvector ############# 6/1 revised
PCAPt3
# PCAPt2=t(qq)%*%top2.pca.eigenvector ############# 6/1 revised
PCAPt3=qq%*%top3.pca.eigenvector ############# 6/1 revised
# top2.pca.eigenvector <- pcaqq$rotation[, 1:2]
top3.pca.eigenvector <- pcaqq$rotation[, 1:3]
# PCAPt2=t(qq)%*%top2.pca.eigenvector ############# 6/1 revised
PCAPt3=qq%*%top3.pca.eigenvector ############# 6/1 revised
top3.pca.eigenvector
qq
dim(qq)
dim(top3.pca.eigenvector)
qq%*%top3.pca.eigenvector
View(qq)
View(top3.pca.eigenvector)
# PCAPt2=t(qq)%*%top2.pca.eigenvector ############# 6/1 revised
PCAPt3=t(qq)%*%top3.pca.eigenvector ############# 6/1 revised
# PCAPt2=t(qq)%*%top2.pca.eigenvector ############# 6/1 revised
PCAPt3=as.matrix(qq)%*%top3.pca.eigenvector ############# 6/1 revised
PCAPt3
# kms2<-kmeans(PCAPt2, 4)
kms3<-kmeans(PCAPt3, 4)
plot3d(PCAPt3 , size = 10, type = "p")
plot3d(PCAPt3 , col = kms3$cluster, size = 3, type = "n")
text3d(PCAPt3, text = n11, col = kms3$cluster)
plot3d(PCAPt3 , col = kms3$cluster, size = 3, type = "p")
plot3d(PCAPt3 , size = 10, type = "p")
kms3$cluster
which(kms3$cluster==1)
which(kms3$cluster==2)
which(kms3$cluster==3)
which(kms3$cluster==4)
qq[483,]
qq[556,]
setwd("C:/Users/user/Desktop/AMSA/FINAL/目前最新/0608後/DATA")
rm(list=ls())
qq=read.csv("(去程)路線11老人搭車習慣.csv")
qq[1:10,1:10]
comdata<-read.csv("(去程)替代路名對照.csv" ,header = TRUE, sep = ",")
n11<-c("台東","新生站","中央市場","署東醫院","簡易法庭","變電所","新生國小","更生路","四維路口",
"馬蘭加油站","公東高工","馬蘭榮家","卑南農會","卑南","卑南國小","南王",
"卑南國中","十股","下賓朗","賓朗","種蓄場","美濃入口","東成","美濃","集貨場","煙草間","初鹿國中",
"明峰","初鹿","龍過脈","嘉豐入口","舊鹿鳴","四維","湖底","龍田","光榮","鹿野國中","鹿野","鹿野鄉公所","水源地",
"永隆","永隆分校","永興","永安農場","武陵","武麟山莊","新豐","景豐","加拿","月眉國小",
"月眉","崁頂","親水公園","關山","關山慈濟","螢橋","德高","頂庄","北庄","山平路","海端","隴下","初來","錦屏","陸安",
"大同農場","池上鄉公所","池上郵局","池上站","慶豐","富南國小","富里")
for(i in c(1:nrow(comdata))){       #替換掉站名
for(j in c(1:length(n11))){
if(comdata[i,1]==n11[j]){
n11[j]=as.character(comdata[i,2])
}
}
}
colnames(qq)<-n11
pcaqq = prcomp(qq, center = T) ############# 6/1 revised
pcaqq$sdev
vars <- (pcaqq$sdev)^2
vars
props <- vars / sum(vars)
props
cumulative.props <- cumsum(props)  # 累加前n個元素的值
cumulative.props
windows()
plot(cumulative.props,xlab = "PCA個數", ylab = "cumulative variance" )
# top2.pca.eigenvector <- pcaqq$rotation[, 1:2]
top3.pca.eigenvector <- pcaqq$rotation[, 1:3]
# top8.pca.eigenvector <- pcaqq$rotation[, 1:8]
# PCAPt2=t(qq)%*%top2.pca.eigenvector ############# 6/1 revised
PCAPt3=as.matrix(qq)%*%top3.pca.eigenvector ############# 6/1 revised
# PCAPt8=t(qq)%*%top8.pca.eigenvector ############# 6/1 revised
# kms2<-kmeans(PCAPt2, 4)
kms3<-kmeans(PCAPt3, 4)
# kms8<-kmeans(PCAPt8, 4)
kms3$cluster
# kms8<-kmeans(PCAPt8, 3)
# plot(PCAPt2, col = kms2$cluster )#, xlim = c(-10,50), ylim = c(-45,10))
# points(kms2$centers, col = 1:4, pch = 1, cex = 30)
# points(kms2$centers, col = 1:4, pch = 1, cex = 20)
# points(kms2$centers, col = 1:4, pch = 1, cex = 10)
# points(kms2$centers, col = 1:4, pch = 8, cex = 2)
#
# points(PCAPt2[2,], col = "dark orange", pch = 9, cex = 8)
# max(PCAPt2[,1])
# max(PCAPt2[,2])
#
# min(PCAPt2[,1])
# min(PCAPt2[,2])
library(rgl)
plot3d(PCAPt3 , size = 10, type = "p")
plot3d(PCAPt3 , size = 10, type = "p")
kms3$cluster
which(kms3$cluster==1)
which(kms3$cluster==2)
which(kms3$cluster==3)
which(kms3$cluster==4)
qq[62,]
qq[397,]
qq[99,]
qq[100,]
